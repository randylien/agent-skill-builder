# æ•æ„Ÿè³‡è¨Šæª¢æŸ¥è¦å‰‡åƒè€ƒ

è¤‡è£½æ­¤æª”æ¡ˆåˆ°ä½ çš„å°ˆæ¡ˆæ ¹ç›®éŒ„æˆ– `.git` åŒå±¤ç›®éŒ„ï¼Œå‘½åç‚º `REFERENCE.md`ï¼Œä¸¦æ ¹æ“šä½ çš„éœ€æ±‚èª¿æ•´è¦å‰‡ã€‚

---

## API Keys & Tokens

### AWS Keys
```regex
AKIA[0-9A-Z]{16}
aws_access_key_id\s*=\s*['"]?[A-Z0-9]{20}['"]?
aws_secret_access_key\s*=\s*['"]?[A-Za-z0-9/+=]{40}['"]?
```

### Google Cloud Platform
```regex
AIza[0-9A-Za-z\-_]{35}
ya29\.[0-9A-Za-z\-_]+
[0-9]+-[0-9A-Za-z_]{32}\.apps\.googleusercontent\.com
```

### Stripe Keys
```regex
sk_live_[0-9a-zA-Z]{24,}
pk_live_[0-9a-zA-Z]{24,}
sk_test_[0-9a-zA-Z]{24,}
```

### GitHub Tokens
```regex
ghp_[0-9a-zA-Z]{36}
gho_[0-9a-zA-Z]{36}
ghs_[0-9a-zA-Z]{36}
github_pat_[0-9a-zA-Z_]{82}
```

### OpenAI / Anthropic
```regex
sk-[a-zA-Z0-9]{48}
sk-ant-[a-zA-Z0-9\-]{95,}
```

### Generic API Keys (é«˜é¢¨éšªæ¨¡å¼)
```regex
api[_-]?key['"]?\s*[:=]\s*['"][a-zA-Z0-9]{32,}['"]
secret['"]?\s*[:=]\s*['"][a-zA-Z0-9]{32,}['"]
token['"]?\s*[:=]\s*['"][a-zA-Z0-9]{32,}['"]
```

### ç§é‘°æª”æ¡ˆ
```regex
-----BEGIN\s+(RSA|EC|OPENSSH|DSA|PGP)\s+PRIVATE\s+KEY-----
```

---

## å€‹äººè­˜åˆ¥è³‡è¨Š (PII)

### å°ç£èº«åˆ†è­‰å­—è™Ÿ
```regex
[A-Z][12]\d{8}
```

### ä¸­åœ‹èº«åˆ†è­‰è™Ÿç¢¼
```regex
\d{17}[\dXx]
```

### ä¿¡ç”¨å¡è™Ÿ (åŸºæœ¬æ ¼å¼)
```regex
\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13})\b
```

### å°ç£æ‰‹æ©Ÿè™Ÿç¢¼
```regex
09\d{2}[-\s]?\d{3}[-\s]?\d{3}
\+886[-\s]?9\d{2}[-\s]?\d{3}[-\s]?\d{3}
```

### Email (åƒ…æª¢æŸ¥ç‰¹å®š domains)
```regex
[a-zA-Z0-9._%+-]+@(yourcompany|partner-company)\.com
```

---

## å…¬å¸/çµ„ç¹”ç‰¹å®šè³‡è¨Š

### å…¬å¸ Email Domains
è«‹æ›¿æ›ç‚ºä½ çš„å…¬å¸åŸŸåï¼š
```regex
@(yourcompany|internal-domain|subsidiary)\.com
@yourcompany\.(tw|cn|jp)
```

### å…§éƒ¨ç³»çµ± URLs
```regex
https?://(internal|intranet|vpn|admin)\.yourcompany\.com
192\.168\.\d{1,3}\.\d{1,3}
10\.\d{1,3}\.\d{1,3}\.\d{1,3}
```

### å°ˆæ¡ˆä»£è™Ÿ/æ©Ÿå¯†åç¨±
```regex
PROJECT-CODENAME-\d+
CONFIDENTIAL-\w+
INTERNAL-USE-ONLY
```

### è³‡æ–™åº«é€£ç·šå­—ä¸²
```regex
mongodb(\+srv)?://[^:]+:[^@]+@
postgresql://[^:]+:[^@]+@
mysql://[^:]+:[^@]+@
redis://[^:]+:[^@]+@
```

### JWT Tokens (ç°¡å–®æª¢æ¸¬)
```regex
eyJ[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}
```

---

## è‡ªè¨‚è¦å‰‡ç¯„ä¾‹

### ç‰¹å®šç”¢å“çš„åºè™Ÿæ ¼å¼
```regex
PROD-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}
```

### å…§éƒ¨å“¡å·¥ç·¨è™Ÿ
```regex
EMP\d{6}
```

---

## ä½¿ç”¨èªªæ˜

1. **è¤‡è£½æ­¤æª”æ¡ˆ**åˆ°å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼š
   ```bash
   cp skills/check-sensitive/REFERENCE.md.example REFERENCE.md
   ```

2. **ç§»é™¤ä¸éœ€è¦çš„è¦å‰‡**ï¼šåˆªé™¤èˆ‡ä½ å°ˆæ¡ˆç„¡é—œçš„æª¢æŸ¥æ¨¡å¼

3. **æ–°å¢è‡ªè¨‚è¦å‰‡**ï¼šæ ¹æ“šä½ çš„å…¬å¸/å°ˆæ¡ˆéœ€æ±‚æ–°å¢ç‰¹å®šæ¨¡å¼

4. **æ¸¬è©¦è¦å‰‡**ï¼š
   ```bash
   node skills/check-sensitive/scripts/test-patterns.js
   ```

## è¦å‰‡æ’°å¯«å»ºè­°

### âœ… å¥½çš„è¦å‰‡
- å…·é«”æ˜ç¢ºï¼Œé¿å…éæ–¼å¯¬é¬†çš„æ¨¡å¼
- åŒ…å«å‰å¾Œæ–‡ï¼ˆå¦‚ `api_key=` è€Œéåªæœ‰ `[A-Z0-9]{32}`ï¼‰
- é‡å°çœŸå¯¦çš„ token æ ¼å¼ï¼ˆå¦‚ `sk-` å‰ç¶´ï¼‰

### âŒ é¿å…çš„è¦å‰‡
- éæ–¼é€šç”¨æœƒç”¢ç”Ÿå¤§é‡èª¤å ±ï¼ˆå¦‚ `\d{10}` å¯èƒ½åŒ¹é…æ™‚é–“æˆ³è¨˜ï¼‰
- æ²’æœ‰é‚Šç•Œæª¢æŸ¥çš„æ¨¡å¼
- æœªè€ƒæ…®å¸¸è¦‹çš„ç·¨ç¢¼æ ¼å¼ï¼ˆbase64, hexï¼‰

## é™ä½èª¤å ±çš„æŠ€å·§

1. **ä½¿ç”¨å–®è©é‚Šç•Œ** `\b`ï¼š
   ```regex
   \bAKIA[0-9A-Z]{16}\b
   ```

2. **è¦æ±‚ç‰¹å®šå‰ç¶´**ï¼š
   ```regex
   api_key\s*=\s*['"]?([A-Z0-9]{32})['"]?
   ```

3. **ä½¿ç”¨ negative lookahead** æ’é™¤æ¸¬è©¦ç”¨ä¾‹ï¼š
   ```regex
   sk-(?!test_|xxx)[a-zA-Z0-9]{48}
   ```

## æ›´æ–°é »ç‡å»ºè­°

- ğŸ”´ **æ¯å­£æª¢è¦–**ï¼šé›²ç«¯æœå‹™ API key æ ¼å¼æ›´æ–°
- ğŸŸ¡ **æ¯åŠå¹´**ï¼šå…¬å¸çµ„ç¹”è®Šå‹•ï¼ˆæ–°å­å…¬å¸ã€email domainï¼‰
- ğŸŸ¢ **æŒ‰éœ€æ›´æ–°**ï¼šç™¼ç¾æ–°çš„æ•æ„Ÿè³‡è¨Šé¡å‹æ™‚

---

**æ³¨æ„**ï¼šæ­¤æª”æ¡ˆåŒ…å«çš„æ­£è¦è¡¨é”å¼åƒ…ä¾›åƒè€ƒï¼Œè«‹æ ¹æ“šå¯¦éš›éœ€æ±‚èª¿æ•´ç²¾ç¢ºåº¦ã€‚
